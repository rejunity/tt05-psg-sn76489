--- 
# Tiny Tapeout project information
project:
  wokwi_id:    0        # If using wokwi, set this to your project's ID

# If using an HDL, set wokwi_id as 0 and uncomment and list your source files here. 
# Source files must be in ./src and you must list each source file separately
  source_files:
    - attenuation.v
    - tone.v
    - noise.v
    - signal_edge.v
    - pwm.v
    - tt_um_rejunity_sn76489.v
  top_module:  "tt_um_rejunity_sn76489"      # Put the name of your top module here, must start with "tt_um_". Make it unique by including your github username

# How many tiles your design occupies? A single tile is about 167x108 uM.
  tiles: "1x1"    # Valid values: 1x1, 1x2, 2x2, 4x2 or 8x2

# Keep a track of the submission yaml
yaml_version: 4

# As everyone will have access to all designs, try to make it easy for someone new to your design to know what
# it does and how to operate it. This info will be automatically collected and used to make a datasheet for the chip.
documentation: 
  author:       "rej"
  title:        "Classic 8-bit era Programmable Sound Generator SN76489"
  language:     "Verilog"
  description:  "The SN76489 Digital Complex Sound Generator (DCSG) is a programmable sound generator chip from Texas Instruments."

# Longer description of how the project works. You can use standard markdown format.
  how_it_works: |
      This Verilog implementation of the SN76489 programmable sound generator aims to:
      1) closely replicate the behavior of the original chip as introduced in 1980 by Texas Instruments
      2) while being produced with the modern fabrication process.

      Additionally the aim is to provide readable and well commented code for educational and hardware preservation purposes.
      Significant effort was put into a thorough test suite for regression testing and validation against the original chip behavior.

      SN76489 chip contains:
      - 3 square wave tone generators
      - 1 noise generator with two types of noise
      - A wide range of frequencies
      - 16 different volume levels

      Variants of SN76489 chip were used in a number of home computers, game consoles and arcade boards:
      - home computers: TI-99/4, BBC Micro, IBM PCjr, Sega SC-3000, Tandy 1000
      - game consoles: ColecoVision, Sega SG-1000, Sega Master System, Game Gear, Neo Geo Pocket and Sega Genesis
      - arcade machines by Sega & Konami and would usually include 2 or 4 SN76489 chips
      The SN76489 chip family competed with the similar General Instrument AY-3-8910.

      The module is parameterized to replicate the behavior of several SN76489 variants by providing options for:
      - noise tapped bits,
      - tone counter and noise LFSR shift register size,
      - variable clock divider

      This Verilog implementation varies from the the original SN76489 in the following ways:
      - two alternative ways to output audio signal, while the original chip had analog channel summation using internal OpAmp and analog output, this is a purely digital design that does digital signal summation
        a) digital 8-bit audio output suitable for external Digital to Analog Converter (DAC)
        b) pseudo analog output using Pulse Width Modulation (PWM)
      - outputs of all 4 channels are exposed, while the original chip had only single master audio output
      - /OE pin is omitted for simplicity, behavior is the same as if /OE is tied low and chip is always enabled
      - READY pin is omitted for simplicity, unlike the original SN76489 that took 32 cycles to update registers, this implementation updates registers in a single cycle and chip behaves as always READY

      Additionally, a configurable clock divider was introduced. Clock divider can be controlled through SEL0 and SEL1 pins. This allows to select between 3 chip variants:
      1) original SN76489 with the internal clock divided by 16. This chip was intended to be used with PAL and NTSC clock frequencies. In BBC Micro SN76489 was clocked precisely at 4 MHz.
      2) SN94624/SN76494 variants had no internal clock divider and were intended for 250 KHz external clocks.
      3) the newly introduced configuration for high frequency clock in TinyTapeout and is suitable for a range between 25 MHz and 50 Mhz.  In this configuration the clock is internally divided by 128.

      This implementation is informed by the following reverse engineering efforts:
      * https://github.com/gchiasso/76489A-analysis - based on the SN76489A die shots
      * https://github.com/emu-russia/SEGAChips/tree/main/VDP/PSG - based on SN76496 variant included in the Sega Mega Drive VDP chip

      Visit [SN76489 Wikipedia page](https://en.wikipedia.org/wiki/Texas_Instruments_SN76489) for more general information.
      Original datasheet and programming manual can be found [here](https://ftp.whtech.com/datasheets%20and%20manuals/Datasheets%20-%20TI/SN76489.pdf).

# Instructions on how someone could test your project, include things like what buttons do what and how to set the clock if needed
  how_to_test:  |
      Explain how to test your project

# A description of what the inputs do
  inputs:               
    - D0 - SN76489 data bus
    - D1 - SN76489 data bus
    - D2 - SN76489 data bus
    - D3 - SN76489 data bus
    - D4 - SN76489 data bus
    - D5 - SN76489 data bus
    - D6 - SN76489 data bus
    - D7 - SN76489 data bus
# A description of what the outputs do
  outputs:
    - digital audio LSB - matches Digilent R2R PMOD
    - digital audio
    - digital audio
    - digital audio
    - digital audio
    - digital audio
    - digital audio
    - digital audio MSB - matches Digilent R2R PMOD
# A description of what the bidirectional I/O pins do
  bidirectional:
    - /WE - (in) SN76489 inverted write enable
    - SEL0 - (in) 0 = clock divided by 16 (SN76489 mode), 1 = no divider (SN94624/SN76494 mode)
    - SEL1 - (in) 0 = clock divided by 16 (SN76489 mode), 1 = clock divided by 128
    - channel 0 - (out) pseudo analog / PWM
    - channel 1 - (out) pseudo analog / PWM
    - channel 2 - (out) pseudo analog / PWM
    - channel 3 - (out) pseudo analog / PWM
    - AUDIO OUT - (out) AUDIO OUT pin on original SN76489, pseudo analog / PWM

# The following fields are optional
  tag:          "psg, music, sound" # comma separated list of tags: test, encryption, experiment, clock, animation, utility, industrial, pwm, fpga, alu, microprocessor, risc, riscv, sensor, signal generator, fft, filter, music, bcd, sound, serial, timer, random number generator, calculator, decoder, counter, puzzle, multiplier, game, oscillator,
  external_hw:  "DAC (for ex. Digilent R2R PMOD), RC filter, amplifier, speaker" # Describe any external hardware needed
  discord:      "rzioma"  # Your discord handle, used for communication and automatically assigning tapeout role after a submission
  doc_link:     ""        # URL to longer form documentation, eg the README.md in your repository
  clock_hz:     4000000   # Clock frequency in Hz (if required)
  picture:      "docs/SN76489_small.jpg" # relative path to a picture in your repository (must be 512kb or less)
